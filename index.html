<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Agora SDK Pricing Calculator</title>
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Roboto", sans-serif;
        background: linear-gradient(135deg, #667eea, #764ba2);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
      }
      .calculator-container {
        background: #fff;
        padding: 30px;
        border-radius: 12px;
        box-sizing: border-box;
        box-shadow: 0 15px 25px rgba(0, 0, 0, 0.1);
        max-width: 600px;
        width: 90%;
      }
      h2 {
        text-align: center;
        margin-bottom: 25px;
        color: #333;
        font-weight: 500;
      }
      .form-group {
        margin-bottom: 20px;
      }
      label {
        font-weight: 500;
        color: #555;
      }
      input,
      select {
        padding: 12px 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 16px;
        color: #333;
        outline: none;
        transition: border-color 0.3s;
        box-sizing: border-box;
        width: 100%;
        margin-top: 8px;
      }
      input:focus,
      select:focus {
        border-color: #667eea;
      }
      .button {
        width: 100%;
        background: #667eea;
        color: #fff;
        padding: 15px;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.3s;
        margin-top: 20px;
      }
      .button:hover {
        background: #5a67d8;
      }
      .result {
        margin-top: 30px;
        text-align: center;
        font-size: 20px;
        color: #333;
        font-weight: 500;
      }
      .hosts-container {
        margin-bottom: 20px;
      }
      .host-entry {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
      }
      .host-entry label {
        margin-right: 10px;
        width: 70px;
      }
      .host-entry select {
        flex: 1;
        margin-right: 10px;
      }
      .add-host-btn {
        background: #48bb78;
        color: #fff;
        padding: 10px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        margin-bottom: 20px;
        transition: background 0.3s;
      }
      .add-host-btn:hover {
        background: #38a169;
      }
      .remove-host-btn {
        background: #e53e3e;
        color: #fff;
        padding: 8px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.3s;
      }
      .remove-host-btn:hover {
        background: #c53030;
      }
    </style>
  </head>
  <body>
    <div class="calculator-container">
      <h2>Agora SDK Pricing Calculator</h2>
      <div class="form-group">
        <button class="add-host-btn" onclick="addHost()">Add Host</button>
        <div class="hosts-container" id="hosts-container"></div>
      </div>
      <div class="form-group">
        <label for="audience">Number of Audience Members:</label>
        <input
          type="number"
          id="audience"
          placeholder="Enter number of audience members"
          min="0"
        />
      </div>
      <div class="form-group">
        <label for="duration">Duration (in minutes):</label>
        <input
          type="number"
          id="duration"
          placeholder="Enter duration in minutes"
          min="1"
        />
      </div>
      <div class="form-group">
        <label for="discount">Discount (%):</label>
        <input
          type="number"
          id="discount"
          placeholder="Enter discount percentage"
          min="0"
          max="100"
        />
      </div>

      <!-- AINS Checkbox -->
      <div class="form-group checkbox-container" style="display: flex; align-items: center; white-space: nowrap;">
        <label for="ains" style="flex-grow: 1;">Enable AINS (Additional Cost)</label>
        <input type="checkbox" id="ains" style="margin-right: 275px;" />
      </div>

      <!-- Participant Screen Share Checkbox -->
      <div class="form-group checkbox-container" style="display: flex; align-items: center; white-space: nowrap;">
        <label for="screenshare" style="flex-grow: 1;">Enable Screenshare</label>
        <input type="checkbox" id="screenshare" style="margin-right: 200px;" onchange="toggleParticipantResolution()" />
      </div>

      <!-- Participant Resolution Selection -->
      <div class="form-group" id="participant-resolution-group" style="display: none;">
        <label for="participant-resolution">Screenshare Resolution:</label>
        <select id="participant-resolution">
          <option value="120p">120p</option>
          <option value="360p">360p</option>
          <option value="480p">480p</option>
          <option value="720p">720p</option>
          <option value="1080p">1080p</option>
          <option value="4k">4K</option>
        </select>
      </div>

      <button class="button" onclick="calculatePricing()">Calculate</button>
      <div class="result" id="result"></div>

      <p style="margin-top: 20px; text-align: center; color: #555; font-size: 14px;">
        Disclaimer: This is not an official calculator and may provide incorrect estimates. This will overestimate the host cost.
      </p>
    </div>

    <script>
      function updateHostLabels() {
        const hostEntries = document.querySelectorAll(".host-entry");
        hostEntries.forEach((entry, index) => {
          const label = entry.querySelector("label");
          label.textContent = "Host " + (index + 1);
        });
      }

      function addHost() {
        const hostEntry = document.createElement("div");
        hostEntry.className = "host-entry";

        const label = document.createElement("label");

        const select = document.createElement("select");
        select.innerHTML = `
                <option value="120p">120p</option>
                <option value="360p">360p</option>
                <option value="480p">480p</option>
                <option value="720p">720p</option>
                <option value="1080p">1080p</option>
                <option value="4k">4K</option>
            `;

        const removeBtn = document.createElement("button");
        removeBtn.className = "remove-host-btn";
        removeBtn.textContent = "Remove";
        removeBtn.onclick = function () {
          hostEntry.remove();
          updateHostLabels();
        };

        hostEntry.appendChild(label);
        hostEntry.appendChild(select);
        hostEntry.appendChild(removeBtn);

        document.getElementById("hosts-container").appendChild(hostEntry);
        updateHostLabels();
      }

      function toggleParticipantResolution() {
        const screenshareChecked = document.getElementById("screenshare").checked;
        document.getElementById("participant-resolution-group").style.display = screenshareChecked ? 'block' : 'none';
      }

      function calculatePricing() {
        const audience =
          parseInt(document.getElementById("audience").value) || 0;
        const duration =
          parseInt(document.getElementById("duration").value) || 0;
        const discount =
          parseFloat(document.getElementById("discount").value) || 0;
        const ainsEnabled = document.getElementById("ains").checked;
        const screenshareEnabled = document.getElementById("screenshare").checked;
        const participantResolution = document.getElementById("participant-resolution").value;

        if (discount < 0 || discount > 100) {
          alert("Please enter a discount percentage between 0 and 100.");
          return;
        }

        const rates = {
          "120p": 0.05,
          "360p": 0.07,
          "480p": 0.08,
          "720p": 0.2,
          "1080p": 0.4,
          "4k": 0.8,
        };

        let totalHostCost = 0;

        const hostEntries = document.querySelectorAll(".host-entry");
        let aggregatedResolution = 0;

        hostEntries.forEach((entry) => {
          const select = entry.querySelector("select");
          const resolution = select.value;
          switch (resolution) {
            case "120p":
              aggregatedResolution += 160 * 120;
              break;
            case "360p":
              aggregatedResolution += 480 * 360;
              break;
            case "480p":
              aggregatedResolution += 640 * 480;
              break;
            case "720p":
              aggregatedResolution += 1280 * 720;
              break;
            case "1080p":
              aggregatedResolution += 1920 * 1080;
              break;
            case "4k":
              aggregatedResolution += 3840 * 2160;
              break;
          }

          const rate = rates[resolution] || 0;
          totalHostCost += 0; // As per original code, host cost is zero
        });

        // Add participant screen share resolution if enabled
        if (screenshareEnabled) {
          switch (participantResolution) {
            case "120p":
              aggregatedResolution += 160 * 120;
              break;
            case "360p":
              aggregatedResolution += 480 * 360;
              break;
            case "480p":
              aggregatedResolution += 640 * 480;
              break;
            case "720p":
              aggregatedResolution += 1280 * 720;
              break;
            case "1080p":
              aggregatedResolution += 1920 * 1080;
              break;
            case "4k":
              aggregatedResolution += 3840 * 2160;
              break;
          }
        }

        let labelTier = "HD Video";
        let pricingTier = 3.99;

        if (aggregatedResolution > 3686400) {
          labelTier = "2K+ Video";
          pricingTier = 35.99;
        } else if (aggregatedResolution > 2073600) {
          labelTier = "2K Video";
          pricingTier = 15.99;
        } else if (aggregatedResolution > 921600) {
          labelTier = "Full HD Video";
          pricingTier = 8.99;
        }

        const audienceCost = ((audience * duration) / 1000) * pricingTier;

        // Calculate host cost
        let totalHostCalculation = 0;
        const numHosts = hostEntries.length;
        if (numHosts === 1) {
          // For a single host
          totalHostCalculation = (duration * numHosts * 0.99) / 1000;
        } else if (numHosts > 1) {
          // For multiple hosts based on aggregate resolution
          totalHostCalculation = ((duration * numHosts) / 1000) * pricingTier;
        }

        const totalCost = totalHostCalculation + audienceCost;

        // Adding AINS cost if enabled
        const ainsCost = ainsEnabled ? (0.59 * (audience * duration) / 1000) : 0; // Example: AINS adds $.59 to the total cost

        const discountedCost = (totalCost + ainsCost) * (1 - discount / 100);

        document.getElementById("result").textContent =
          discount > 0
            ? `Estimated Cost after ${discount}% discount: $${discountedCost.toFixed(
                2
              )}`
            : `Estimated Cost: $${discountedCost.toFixed(2)}`;
      }
    </script>
  </body>
</html>